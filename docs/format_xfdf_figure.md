# XFDFファイルフォーマット(図形)

`<annots>` の子要素として図形要素を配置する。

```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <xfdf xmlns="http://ns.adobe.com/xfdf/" xml:space="preserve">
        <annots>
            ...
        </annots>
        ...
    </xfdf>
```

主な図形要素には次の種類がある。

* 線・矢印線 `<line>`
* 四角形 `<square>`
* 円・楕円 `<circle>`
* 多角形 `<polygon>`
* 折れ線 `<polyline>`
* 自由曲線 `<ink>`

各図形要素の子要素に `<contents-richtext>` 要素または `<contents>` 要素を配することにより、注釈の説明を付けることができる。

---

## 図形属性

* `width` 線幅(単位はポイント) ※省略時は1ポイント幅
* `style` 線のスタイル指定
  * `"dash"` 破線の指定
  * `"cloudy"` 雲形の指定
* `dashes` 破線の間隔 (`width`>2 でいないと正常に認識しない)
  * dashes="2.000000,2.000000"
  * dashes="3.000000,3.000000"
  * dashes="4.000000,4.000000"
  * dashes="4.000000,3.000000,2.000000,3.000000"
  * dashes="4.000000,3.000000,16.000000,3.000000"
  * dashes="8.000000,4.000000,4.000000,4.000000"
* `intensity` 雲形の間隔
  * intensity="1.000000"
  * intensity="2.000000"
* `inter-color` 領域内の色(#rrggbb) ※省略時は領域色なし
* `fringe` フリンジ(省略可) 通常は `rect` の領域の外側の領域幅

---

## 線・矢印線

線に描く曲線は、 `<line ...>` 要素を使用する。

```xml
    <line 
        color="#E52237" 
        IT="LineArrow" 
        start="263.389130,266.142761" 
        end="302.989594,238.514526" 
        head="None" 
        tail="OpenArrow" 
        page="0" 
        rect="257.889130,233.014526,307.669464,271.642761" >
    </line>
```

* `start` 開始座標
* `end` 終了座標

矢印を付けるには、以下を追加。

* `head` 開始位置の矢印タイプ (不要なら省略可)
* `tail` 終了位置の矢印タイプ (不要なら省略可)

矢印の形状：

* `"None"` 矢印なし
* `"OpenArrow"` 開いた矢印
* `"CloseArrow"` 閉じた矢印
* `"ROpenArrow"` 開いた矢印(内向き)
* `"RCloseArrow"` 閉じた矢印(内向き)
* `"Butt"` 突合わせ
* `"Diamond"` ひし形
* `"Circle"` 円形
* `"Square"` 四角
* `"Slash"` スラッシュ

種別表示を変更する

* `IT="LineArrow"` 「矢印」表示
* `IT="PolygonCloud"` 「雲形」表示

---

## 四角形

四角形は、 `<square ...>` 要素を使用する。

```xml
    <square 
        color="#E52237" 
        page="0" 
        fringe="0.500000,0.500000,0.500000,0.500000" 
        rect="346.694763,238.014526,400.188385,279.535950" >
    </square>
```

---

## 円・楕円

円形は、 `<circle ...>` 要素をを使用する。

```xml
    <circle 
        color="#E52237" 
        page="0" 
        fringe="0.500000,0.500000,0.500000,0.500000" 
        rect="447.998260,225.121338,503.333771,266.642761" >
    </circle>
```

---

## 多角形

多角形は、 `<polygon ...>`  要素を使用する。  
`<polygon>` の子要素 `<vertices>` に頂点の座標を並べる。

```xml
    <polygon 
        color="#E52237" 
        page="0" 
        rect="447.998260,225.121338,503.333771,266.642761" >
        <vertices>
            308.515228,262.458984;
            370.218292,231.146973;
            258.784424,153.787964;
            ...
            308.515228,262.458984
        </vertices>
    </polygon>
```

---

## 折れ線

折れ線は、 `<polyline ...>`  要素を使用する。  
`<polyline>` の子要素 `<vertices>` に頂点の座標を並べる。

```xml
    <polyline 
        color="#E52237" 
        page="0" 
        rect="106.750107,247.644897,468.838013,374.892853" >
        <vertices>
            107.750107,267.984619;
            118.801392,347.185547;
            163.927490,286.403442;
            ...
            467.838013,248.644897
        </vertices>
    </polyline>
```

---

## 自由曲線

自由に描く曲線は、 `<ink ...>` 要素を使用する。  
`<ink ...>` 要素の子要素 `<inkList>` を配する。  
`<inkList>` 要素の子要素 `<gesture>` に曲線の通過点を並べる。  
`<gesture>` 要素は複数並べて複数の線を一つにまとめることができる。

```xml
    <ink 
        color="#E52237" 
        page="0" 
        rect="120.564209,336.055206,198.081390,405.942902" >
        <inklist>
            <gesture>
                121.564209,339.818024;
                122.485153,341.659912;
                124.327042,344.422729;
                ...
                197.081390,337.055206
            </gesture>
            ...
        </inklist>
    </ink>
```

---
